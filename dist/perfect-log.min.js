!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.PerfectLog=t()}(this,function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),r=function(e,t,r){return console[e].bind(window.console,"%c["+t+"]%c","color: "+r,"color:black")},o=void 0,n=void 0,i=void 0,l=function(){function l(){e(this,l)}return t(l,null,[{key:"initialize",value:function(){this.enableConsoleOutput(),this.disableReport(),this.reportOptions={}}},{key:"enableReport",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.reportOptions=Object.assign({level:"ERROR",data:null},t),this.reportOptions.url){switch(this.reportOptions.level){case"ERROR":this.reportOptions.levelNumber=1;break;case"INFO":this.reportOptions.levelNumber=2;break;case"DEBUG":this.reportOptions.levelNumber=3;break;default:return void console.error("Invalid level option. Only ERROR/INFO/DEBUG are allowed.")}this.reportEnabled=!0,this.debug=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(o.apply(void 0,r),e.reportOptions.levelNumber>=3){var i=e._buildReportScheme("DEBUG",e._buildReportMsg(r));e._report(i)}},this.info=function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];if(n.apply(void 0,r),e.reportOptions.levelNumber>=2){var i=e._buildReportScheme("INFO",e._buildReportMsg(r));e._report(i)}},this.error=function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];if(i.apply(void 0,r),e.reportOptions.levelNumber>=1){var n=void 0;n=1===r.length&&r[0]instanceof Error?e._buildReportScheme("ERROR","",r[0]):e._buildReportScheme("ERROR",e._buildReportMsg(r)),e._report(n)}}}else console.error("You must provide a url when enabling report service.")}},{key:"disableReport",value:function(){this.reportEnabled=!1,this.debug=o,this.info=n,this.error=i}},{key:"enableConsoleOutput",value:function(){this.consoleOutput=!0,o=r("log","DEBUG","green"),n=r("info","INFO","blue"),i=r("error","ERROR","red"),this.reportEnabled||(this.debug=o,this.info=n,this.error=i)}},{key:"disableConsoleOutput",value:function(){this.consoleOutput=!1,o=function(){},n=function(){},i=function(){},this.reportEnabled||(this.debug=o,this.info=n,this.error=i)}},{key:"patchData",value:function(e,t){var r={};e&&t&&("string"==typeof e||e instanceof String)?r[e]=t:e&&e instanceof Object&&(r=e),this.reportOptions.data=Object.assign({},this.reportOptions.data,r)}},{key:"_buildReportScheme",value:function(e,t){return{level:e,msg:t,error:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,time:(new Date).toISOString(),data:this.reportOptions.data,platform:{browser:navigator.userAgent}}}},{key:"_report",value:function(e){var t=new XMLHttpRequest;t.onerror=function(){},t.open("POST",this.reportOptions.url,!0);var r=e;this.reportOptions.beforeSend&&this.reportOptions.beforeSend instanceof Function&&(r=this.reportOptions.beforeSend.call(null,e)),t.send(JSON.stringify(r))}},{key:"_buildReportMsg",value:function(e){return e.map(function(e){return JSON.stringify(e)}).join(", ")}}]),l}();return l.initialize(),l});
